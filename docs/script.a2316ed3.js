parcelRequire=function(e,r,n){var t="function"==typeof parcelRequire&&parcelRequire,i="function"==typeof require&&require;function u(n,o){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!o&&f)return f(n,!0);if(t)return t(n,!0);if(i&&"string"==typeof n)return i(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}a.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,a,l,l.exports)}return r[n].exports;function a(e){return u(a.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=t;for(var o=0;o<n.length;o++)u(n[o]);return u}({9:[function(require,module,exports) {
"use strict";function t(){this.create=function(){return new Float32Array(16)},this.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},this.multiply=function(t,r,n){var a=t[0],e=t[1],i=t[2],s=t[3],h=t[4],u=t[5],o=t[6],c=t[7],f=t[8],M=t[9],v=t[10],p=t[11],l=t[12],y=t[13],A=t[14],w=t[15],I=r[0],q=r[1],d=r[2],P=r[3],m=r[4],b=r[5],g=r[6],x=r[7],F=r[8],V=r[9],_=r[10],j=r[11],k=r[12],z=r[13],O=r[14],B=r[15];return n[0]=I*a+q*h+d*f+P*l,n[1]=I*e+q*u+d*M+P*y,n[2]=I*i+q*o+d*v+P*A,n[3]=I*s+q*c+d*p+P*w,n[4]=m*a+b*h+g*f+x*l,n[5]=m*e+b*u+g*M+x*y,n[6]=m*i+b*o+g*v+x*A,n[7]=m*s+b*c+g*p+x*w,n[8]=F*a+V*h+_*f+j*l,n[9]=F*e+V*u+_*M+j*y,n[10]=F*i+V*o+_*v+j*A,n[11]=F*s+V*c+_*p+j*w,n[12]=k*a+z*h+O*f+B*l,n[13]=k*e+z*u+O*M+B*y,n[14]=k*i+z*o+O*v+B*A,n[15]=k*s+z*c+O*p+B*w,n},this.scale=function(t,r,n){return n[0]=t[0]*r[0],n[1]=t[1]*r[0],n[2]=t[2]*r[0],n[3]=t[3]*r[0],n[4]=t[4]*r[1],n[5]=t[5]*r[1],n[6]=t[6]*r[1],n[7]=t[7]*r[1],n[8]=t[8]*r[2],n[9]=t[9]*r[2],n[10]=t[10]*r[2],n[11]=t[11]*r[2],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},this.translate=function(t,r,n){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[0]*r[0]+t[4]*r[1]+t[8]*r[2]+t[12],n[13]=t[1]*r[0]+t[5]*r[1]+t[9]*r[2]+t[13],n[14]=t[2]*r[0]+t[6]*r[1]+t[10]*r[2]+t[14],n[15]=t[3]*r[0]+t[7]*r[1]+t[11]*r[2]+t[15],n},this.rotate=function(t,r,n,a){var e=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);if(!e)return null;var i=n[0],s=n[1],h=n[2];1!=e&&(i*=e=1/e,s*=e,h*=e);var u=Math.sin(r),o=Math.cos(r),c=1-o,f=t[0],M=t[1],v=t[2],p=t[3],l=t[4],y=t[5],A=t[6],w=t[7],I=t[8],q=t[9],d=t[10],P=t[11],m=i*i*c+o,b=s*i*c+h*u,g=h*i*c-s*u,x=i*s*c-h*u,F=s*s*c+o,V=h*s*c+i*u,_=i*h*c+s*u,j=s*h*c-i*u,k=h*h*c+o;return r?t!=a&&(a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]):a=t,a[0]=f*m+l*b+I*g,a[1]=M*m+y*b+q*g,a[2]=v*m+A*b+d*g,a[3]=p*m+w*b+P*g,a[4]=f*x+l*F+I*V,a[5]=M*x+y*F+q*V,a[6]=v*x+A*F+d*V,a[7]=p*x+w*F+P*V,a[8]=f*_+l*j+I*k,a[9]=M*_+y*j+q*k,a[10]=v*_+A*j+d*k,a[11]=p*_+w*j+P*k,a},this.lookAt=function(t,r,n,a){var e,i,s,h,u,o,c,f,M,v,p=t[0],l=t[1],y=t[2],A=n[0],w=n[1],I=n[2],q=r[0],d=r[1],P=r[2];return p==q&&l==d&&y==P?this.identity(a):(c=p-r[0],f=l-r[1],M=y-r[2],e=w*(M*=v=1/Math.sqrt(c*c+f*f+M*M))-I*(f*=v),i=I*(c*=v)-A*M,s=A*f-w*c,(v=Math.sqrt(e*e+i*i+s*s))?(e*=v=1/v,i*=v,s*=v):(e=0,i=0,s=0),h=f*s-M*i,u=M*e-c*s,o=c*i-f*e,(v=Math.sqrt(h*h+u*u+o*o))?(h*=v=1/v,u*=v,o*=v):(h=0,u=0,o=0),a[0]=e,a[1]=h,a[2]=c,a[3]=0,a[4]=i,a[5]=u,a[6]=f,a[7]=0,a[8]=s,a[9]=o,a[10]=M,a[11]=0,a[12]=-(e*p+i*l+s*y),a[13]=-(h*p+u*l+o*y),a[14]=-(c*p+f*l+M*y),a[15]=1,a)},this.perspective=function(t,r,n,a,e){var i=n*Math.tan(t*Math.PI/360),s=2*(i*r),h=2*i,u=a-n;return e[0]=2*n/s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*n/h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=-(a+n)/u,e[11]=-1,e[12]=0,e[13]=0,e[14]=-a*n*2/u,e[15]=0,e},this.ortho=function(t,r,n,a,e,i,s){var h=r-t,u=n-a,o=i-e;return s[0]=2/h,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2/u,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=-2/o,s[11]=0,s[12]=-(t+r)/h,s[13]=-(n+a)/u,s[14]=-(i+e)/o,s[15]=1,s},this.transpose=function(t,r){return r[0]=t[0],r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=t[1],r[5]=t[5],r[6]=t[9],r[7]=t[13],r[8]=t[2],r[9]=t[6],r[10]=t[10],r[11]=t[14],r[12]=t[3],r[13]=t[7],r[14]=t[11],r[15]=t[15],r},this.inverse=function(t,r){var n=t[0],a=t[1],e=t[2],i=t[3],s=t[4],h=t[5],u=t[6],o=t[7],c=t[8],f=t[9],M=t[10],v=t[11],p=t[12],l=t[13],y=t[14],A=t[15],w=n*h-a*s,I=n*u-e*s,q=n*o-i*s,d=a*u-e*h,P=a*o-i*h,m=e*o-i*u,b=c*l-f*p,g=c*y-M*p,x=c*A-v*p,F=f*y-M*l,V=f*A-v*l,_=M*A-v*y,j=1/(w*_-I*V+q*F+d*x-P*g+m*b);return r[0]=(h*_-u*V+o*F)*j,r[1]=(-a*_+e*V-i*F)*j,r[2]=(l*m-y*P+A*d)*j,r[3]=(-f*m+M*P-v*d)*j,r[4]=(-s*_+u*x-o*g)*j,r[5]=(n*_-e*x+i*g)*j,r[6]=(-p*m+y*q-A*I)*j,r[7]=(c*m-M*q+v*I)*j,r[8]=(s*V-h*x+o*b)*j,r[9]=(-n*V+a*x-i*b)*j,r[10]=(p*P-l*q+A*w)*j,r[11]=(-c*P+f*q-v*w)*j,r[12]=(-s*F+h*g-u*b)*j,r[13]=(n*F-a*g+e*b)*j,r[14]=(-p*d+l*I-y*w)*j,r[15]=(c*d-f*I+M*w)*j,r}}function r(){this.create=function(){return new Float32Array(4)},this.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},this.inverse=function(t,r){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r},this.normalize=function(t){var r=t[0],n=t[1],a=t[2],e=t[3],i=Math.sqrt(r*r+n*n+a*a+e*e);return 0===i?(t[0]=0,t[1]=0,t[2]=0,t[3]=0):(i=1/i,t[0]=r*i,t[1]=n*i,t[2]=a*i,t[3]=e*i),t},this.multiply=function(t,r,n){var a=t[0],e=t[1],i=t[2],s=t[3],h=r[0],u=r[1],o=r[2],c=r[3];return n[0]=a*c+s*h+e*o-i*u,n[1]=e*c+s*u+i*h-a*o,n[2]=i*c+s*o+a*u-e*h,n[3]=s*c-a*h-e*u-i*o,n},this.rotate=function(t,r,n){var a=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);if(!a)return null;var e=r[0],i=r[1],s=r[2];1!=a&&(e*=a=1/a,i*=a,s*=a);var h=Math.sin(.5*t);return n[0]=e*h,n[1]=i*h,n[2]=s*h,n[3]=Math.cos(.5*t),n},this.toVecIII=function(t,r,n){var a=this.create(),e=this.create(),i=this.create();return this.inverse(r,i),a[0]=t[0],a[1]=t[1],a[2]=t[2],this.multiply(i,a,e),this.multiply(e,r,i),n[0]=i[0],n[1]=i[1],n[2]=i[2],n},this.toMatIV=function(t,r){var n=t[0],a=t[1],e=t[2],i=t[3],s=n+n,h=a+a,u=e+e,o=n*s,c=n*h,f=n*u,M=a*h,v=a*u,p=e*u,l=i*s,y=i*h,A=i*u;return r[0]=1-(M+p),r[1]=c-A,r[2]=f+y,r[3]=0,r[4]=c+A,r[5]=1-(o+p),r[6]=v-l,r[7]=0,r[8]=f-y,r[9]=v+l,r[10]=1-(o+M),r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},this.slerp=function(t,r,n,a){var e=t[0]*r[0]+t[1]*r[1]+t[2]*r[2]+t[3]*r[3],i=1-e*e;if(i<=0)a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3];else if(i=Math.sqrt(i),Math.abs(i)<1e-4)a[0]=.5*t[0]+.5*r[0],a[1]=.5*t[1]+.5*r[1],a[2]=.5*t[2]+.5*r[2],a[3]=.5*t[3]+.5*r[3];else{var s=Math.acos(e),h=s*n,u=Math.sin(s-h)/i,o=Math.sin(h)/i;a[0]=t[0]*u+r[0]*o,a[1]=t[1]*u+r[1]*o,a[2]=t[2]*u+r[2]*o,a[3]=t[3]*u+r[3]*o}return a}}function n(t,r,n,a,e){var s,h,u,o=new Array,c=new Array,f=new Array,M=new Array,v=new Array;for(s=0;s<=t;s++){var p=2*Math.PI/t*s,l=Math.cos(p),y=Math.sin(p);for(h=0;h<=r;h++){var A=2*Math.PI/r*h,w=(l*n+a)*Math.cos(A),I=y*n,q=(l*n+a)*Math.sin(A),d=l*Math.cos(A),P=l*Math.sin(A);u=e||i(360/r*h,1,1,1);var m=1/r*h,b=1/t*s+.5;b>1&&(b-=1),b=1-b,o.push(w,I,q),c.push(d,y,P),f.push(u[0],u[1],u[2],u[3]),M.push(m,b)}}for(s=0;s<t;s++)for(h=0;h<r;h++)p=(r+1)*s+h,v.push(p,p+r+1,p+1),v.push(p+r+1,p+r+2,p+1);return{p:o,n:c,c:f,t:M,i:v}}function a(t,r,n,a){var e,s,h,u=new Array,o=new Array,c=new Array,f=new Array,M=new Array;for(e=0;e<=t;e++){var v=Math.PI/t*e,p=Math.cos(v),l=Math.sin(v);for(s=0;s<=r;s++){var y=2*Math.PI/r*s,A=l*n*Math.cos(y),w=p*n,I=l*n*Math.sin(y),q=l*Math.cos(y),d=l*Math.sin(y);h=a||i(360/t*e,1,1,1),u.push(A,w,I),o.push(q,p,d),c.push(h[0],h[1],h[2],h[3]),f.push(1-1/r*s,1/t*e)}}for(v=0,e=0;e<t;e++)for(s=0;s<r;s++)v=(r+1)*e+s,M.push(v,v+1,v+r+2),M.push(v,v+r+2,v+r+1);return{p:u,n:o,c:c,t:f,i:M}}function e(t,r){for(var n,a=.5*t,e=[-a,-a,a,a,-a,a,a,a,a,-a,a,a,-a,-a,-a,-a,a,-a,a,a,-a,a,-a,-a,-a,a,-a,-a,a,a,a,a,a,a,a,-a,-a,-a,-a,a,-a,-a,a,-a,a,-a,-a,a,a,-a,-a,a,a,-a,a,a,a,a,-a,a,-a,-a,-a,-a,-a,a,-a,a,a,-a,a,-a],s=new Array,h=0;h<e.length/3;h++)n=r||i(360/e.length/3*h,1,1,1),s.push(n[0],n[1],n[2],n[3]);return{p:e,n:[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],c:s,t:[0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],i:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]}}function i(t,r,n,a){if(!(r>1||n>1||a>1)){var e=t%360,i=Math.floor(e/60),s=e/60-i,h=n*(1-r),u=n*(1-r*s),o=n*(1-r*(1-s)),c=new Array;if(!r>0&&!r<0)c.push(n,n,n,a);else{var f=new Array(n,u,h,h,o,n),M=new Array(o,n,n,u,h,h),v=new Array(h,h,o,n,n,u);c.push(f[i],M[i],v[i],a)}return c}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t;
},{}],10:[function(require,module,exports) {
module.exports="#define GLSLIFY 1\nattribute vec2 texCoord;\nuniform   mat4 mvpMatrix;\nuniform   float size;\nuniform sampler2D positionTexture;\nvarying vec2 vTexCoord;\nvarying vec4 vPosition;\nconst float pointSize = 10.;\nvoid main(){\n  vTexCoord = texCoord;\n  vec4 position = texture2D(positionTexture, texCoord);\n  vPosition = position;\n  gl_Position = mvpMatrix * vec4(position.xyz, 1.0);\n  gl_PointSize = pointSize * (size / 930.) * position.z;\n}\n";
},{}],11:[function(require,module,exports) {
module.exports="/* ----------------------------------------------------------------------------\n * scene shader\n * ---------------------------------------------------------------------------- */\nprecision mediump float;\n#define GLSLIFY 1\nuniform sampler2D videoTexture;\nuniform float     bgColor;\nvarying vec2 vTexCoord;\nvarying vec4 vPosition;\nconst float maxColor = 0.9;\nconst float minColor = 0.1;\nvoid main(){\n  vec4 video = texture2D(videoTexture, vTexCoord);\n  float rate = vPosition.z / vPosition.w;\n  vec3 color = video.rgb * (maxColor - minColor) + minColor;\n  gl_FragColor = vec4(color + maxColor * (1. - rate) * (-1. * (1. - bgColor) + 1. * bgColor), rate);\n}\n";
},{}],12:[function(require,module,exports) {
module.exports="#define GLSLIFY 1\nattribute vec3 position;\nvoid main(){\n    gl_Position = vec4(position, 1.0);\n}\n";
},{}],13:[function(require,module,exports) {
module.exports="/* ----------------------------------------------------------------------------\n * position update shader\n * ---------------------------------------------------------------------------- */\nprecision mediump float;\n#define GLSLIFY 1\nuniform vec2      resolution;\nuniform sampler2D videoTexture;\nvoid main(){\n  vec2 coord = gl_FragCoord.st / resolution;\n  coord.y = 1. - coord.y;\n  gl_FragColor = texture2D(videoTexture, coord);\n}\n";
},{}],15:[function(require,module,exports) {
module.exports="/* ----------------------------------------------------------------------------\n * velocity update shader\n * ---------------------------------------------------------------------------- */\nprecision mediump float;\n#define GLSLIFY 1\nuniform sampler2D videoTexture;\nuniform sampler2D prevVideoTexture;\nuniform sampler2D prevPictureTexture;\nuniform vec2      resolution;\nconst float threshold = 0.1;\nconst float fadeoutSpeed = 0.04;\nconst float attenuationRate = 1. - fadeoutSpeed;\nvoid main(){\n  vec2 coord = gl_FragCoord.st / resolution;\n  vec4 video = texture2D(videoTexture, coord);\n  vec4 prevVideo = texture2D(prevVideoTexture, coord);\n  vec4 prevPicture = texture2D(prevPictureTexture, coord);\n  float diff = abs(((video.r + video.g + video.b) - (prevVideo.r + prevVideo.g + prevVideo.b))) / 3.;\n  vec3 prevColor = prevPicture.rgb * attenuationRate;\n  float isMove = step(threshold, diff);\n  gl_FragColor = vec4(video.rgb, 1.) * isMove + vec4(prevColor, 0.) * (1. - isMove);\n}\n";
},{}],17:[function(require,module,exports) {
module.exports="/* ----------------------------------------------------------------------------\n * reset shader\n * ---------------------------------------------------------------------------- */\nprecision mediump float;\n#define GLSLIFY 1\nuniform vec2 resolution;\nvoid main(){\n  vec2 coord = gl_FragCoord.st / resolution;\n  vec2 p = (coord * 2. - 1.) * resolution * 0.01;\n  gl_FragColor = vec4(p, 1., 1.);\n}\n";
},{}],19:[function(require,module,exports) {
module.exports="/* ----------------------------------------------------------------------------\n * position update shader\n * ---------------------------------------------------------------------------- */\nprecision mediump float;\n#define GLSLIFY 1\nuniform sampler2D prevPositionTexture;\nuniform sampler2D velocityTexture;\nuniform sampler2D pictureTexture;\nuniform vec2      resolution;\nuniform float     isAnimation1;\nconst float maxZ = 1.;\nconst float minZ = 0.3;\nvoid main(){\n  vec2 coord = gl_FragCoord.st / resolution;\n  vec4 prevPosition = texture2D(prevPositionTexture, coord);\n  vec4 velocity = texture2D(velocityTexture, coord);\n  vec4 picture = texture2D(pictureTexture, coord);\n  float color = picture.x + picture.y + picture.z;\n  float startZ = color / 3. * (maxZ - minZ) + minZ;\n  float animation1Z = startZ * picture.w + (prevPosition.z - velocity.z) * (1. - picture.w);\n  float animation2Z = step(0.01, color) * minZ + color * 0.3;\n  float z = animation1Z * isAnimation1 + animation2Z * (1. - isAnimation1);\n  gl_FragColor = vec4(prevPosition.xy, z, startZ * picture.w + prevPosition.w * (1. - picture.w));\n}\n";
},{}],21:[function(require,module,exports) {
module.exports="/* ----------------------------------------------------------------------------\n * velocity update shader\n * ---------------------------------------------------------------------------- */\nprecision mediump float;\n#define GLSLIFY 1\nuniform sampler2D prevVelocityTexture;\nuniform sampler2D pictureTexture;\nuniform vec2      resolution;\nuniform float     time;\nuniform vec2      mouse;\nconst float speed = 0.0004;\nvoid main(){\n  vec2 coord = gl_FragCoord.st / resolution;\n  vec4 prevVelocity = texture2D(prevVelocityTexture, coord);\n  vec4 picture = texture2D(pictureTexture, coord);\n  float velocityZ = (speed + prevVelocity.z) * (1. - picture.w);\n  gl_FragColor = vec4(prevVelocity.xy, velocityZ, 0.);\n}\n";
},{}],6:[function(require,module,exports) {
"use strict";var e=require("./minMatrix.js"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(){var e=void 0,r=void 0,n=void 0,o=void 0,a=void 0,u=void 0,T=void 0,E=[0,0],c=void 0,f=void 0,R=void 0,m=void 0,l=void 0,d=void 0,L=128,p=1,g=3,s=5,_=7;function U(t){c.attLocation[0]=o.getAttribLocation(c.program,"texCoord"),c.attStride[0]=2,c.uniLocation[0]=o.getUniformLocation(c.program,"mvpMatrix"),c.uniLocation[1]=o.getUniformLocation(c.program,"size"),c.uniLocation[2]=o.getUniformLocation(c.program,"videoTexture"),c.uniLocation[3]=o.getUniformLocation(c.program,"positionTexture"),c.uniLocation[4]=o.getUniformLocation(c.program,"bgColor"),c.uniType[0]="uniformMatrix4fv",c.uniType[1]="uniform1f",c.uniType[2]="uniform1i",c.uniType[3]="uniform1i",c.uniType[4]="uniform1f",f.attLocation[0]=o.getAttribLocation(f.program,"position"),f.attStride[0]=3,f.uniLocation[0]=o.getUniformLocation(f.program,"resolution"),f.uniLocation[1]=o.getUniformLocation(f.program,"videoTexture"),f.uniType[0]="uniform2fv",f.uniType[1]="uniform1i",R.attLocation[0]=o.getAttribLocation(R.program,"position"),R.attStride[0]=3,R.uniLocation[0]=o.getUniformLocation(R.program,"resolution"),R.uniLocation[1]=o.getUniformLocation(R.program,"videoTexture"),R.uniLocation[2]=o.getUniformLocation(R.program,"prevVideoTexture"),R.uniLocation[3]=o.getUniformLocation(R.program,"prevPictureTexture"),R.uniType[0]="uniform2fv",R.uniType[1]="uniform1i",R.uniType[2]="uniform1i",R.uniType[3]="uniform1i",m.attLocation[0]=o.getAttribLocation(m.program,"position"),m.attStride[0]=3,m.uniLocation[0]=o.getUniformLocation(m.program,"resolution"),m.uniLocation[1]=o.getUniformLocation(m.program,"videoTexture"),m.uniType[0]="uniform2fv",m.uniType[1]="uniform1i",d.attLocation[0]=o.getAttribLocation(d.program,"position"),d.attStride[0]=3,d.uniLocation[0]=o.getUniformLocation(d.program,"prevVelocityTexture"),d.uniLocation[1]=o.getUniformLocation(d.program,"pictureTexture"),d.uniLocation[2]=o.getUniformLocation(d.program,"resolution"),d.uniLocation[3]=o.getUniformLocation(d.program,"time"),d.uniLocation[4]=o.getUniformLocation(d.program,"mouse"),d.uniType[0]="uniform1i",d.uniType[1]="uniform1i",d.uniType[2]="uniform2fv",d.uniType[3]="uniform1f",d.uniType[4]="uniform2fv",l.attLocation[0]=o.getAttribLocation(l.program,"position"),l.attStride[0]=3,l.uniLocation[0]=o.getUniformLocation(l.program,"prevPositionTexture"),l.uniLocation[1]=o.getUniformLocation(l.program,"velocityTexture"),l.uniLocation[2]=o.getUniformLocation(l.program,"pictureTexture"),l.uniLocation[3]=o.getUniformLocation(l.program,"resolution"),l.uniLocation[4]=o.getUniformLocation(l.program,"isAnimation1"),l.uniType[0]="uniform1i",l.uniType[1]="uniform1i",l.uniType[2]="uniform1i",l.uniType[3]="uniform2fv",l.uniType[4]="uniform1f";for(var i=256,U=256,A=i/L/i,v=U/L/U,F=[],D=0;D<1;D+=v){var h=D%(v*2)===v;for(var N=0;N<1;N+=A){var X=(h?1:0)+N*(h?-1:1);F.push(X,D)}}var I=[b(F)];F=[];for(var w=0;w<1-v;w+=v){for(var B=0;B<1;B+=A){if(B===i-A){F.push(B,w);F.push(B,w+v)}else{F.push(B,w);F.push(B,w+v);F.push(B+A,w+v);F.push(B,w)}}}var P=[b(F)],M=[1,1,0,-1,1,0,1,-1,0,-1,-1,0],G=[1,0,0,0,1,1,0,1],O=[0,1,2,2,1,3],C=[b(M)],H=x(O),k=[b(M),b(G)],q=T.identity(T.create()),Y=T.identity(T.create()),W=T.identity(T.create()),V=T.identity(T.create()),j=T.identity(T.create());T.lookAt([0,0,5/(i/L)],[0,0,0],[0,1,0],Y),T.perspective(60,r/n,.1,20,W),T.multiply(W,Y,V);var z=[y(a,L,L),y(a,L,L)],K=[y(a,L,L),y(a,L,L)],J=[y(a,L,L),y(a,L,L)],Q=[y(a,L,L),y(a,L,L)];o.activeTexture(o.TEXTURE0+p),o.bindTexture(o.TEXTURE_2D,z[0].texture),o.activeTexture(o.TEXTURE0+p+1),o.bindTexture(o.TEXTURE_2D,z[1].texture),o.activeTexture(o.TEXTURE0+g),o.bindTexture(o.TEXTURE_2D,K[0].texture),o.activeTexture(o.TEXTURE0+g+1),o.bindTexture(o.TEXTURE_2D,K[1].texture),o.activeTexture(o.TEXTURE0+s),o.bindTexture(o.TEXTURE_2D,Q[0].texture),o.activeTexture(o.TEXTURE0+s+1),o.bindTexture(o.TEXTURE_2D,Q[1].texture),o.activeTexture(o.TEXTURE0+_),o.bindTexture(o.TEXTURE_2D,J[0].texture),o.activeTexture(o.TEXTURE0+_+1),o.bindTexture(o.TEXTURE_2D,J[1].texture),o.useProgram(f.program),o[f.uniType[0]](f.uniLocation[0],[L,L]),o[f.uniType[1]](f.uniLocation[1],0),S(C,f.attLocation,f.attStride,H),o.viewport(0,0,L,L);for(var Z=0;Z<=1;++Z){o.bindFramebuffer(o.FRAMEBUFFER,z[Z].framebuffer);o.clearColor(0,0,0,0);o.clear(o.COLOR_BUFFER_BIT);o.drawElements(o.TRIANGLES,O.length,o.UNSIGNED_SHORT,0)}var $=o.createTexture(o.TEXTURE_2D);o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,$),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,t),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.useProgram(R.program),o[R.uniType[0]](R.uniLocation[0],[L,L]),o[R.uniType[1]](R.uniLocation[1],0),S(C,R.attLocation,R.attStride),o.viewport(0,0,L,L);for(var ee=0;ee<=1;++ee){o.bindFramebuffer(o.FRAMEBUFFER,K[ee].framebuffer);o.clearColor(0,0,0,0);o.clear(o.COLOR_BUFFER_BIT);o.drawElements(o.TRIANGLES,O.length,o.UNSIGNED_SHORT,0)}o.useProgram(m.program),o[m.uniType[0]](m.uniLocation[0],[L,L]),o[m.uniType[1]](m.uniLocation[1],0),S(C,m.attLocation,m.attStride,H),o.viewport(0,0,L,L);for(var te=0;te<=1;++te){o.bindFramebuffer(o.FRAMEBUFFER,J[te].framebuffer);o.clearColor(0,0,0,0);o.clear(o.COLOR_BUFFER_BIT);o.drawElements(o.TRIANGLES,O.length,o.UNSIGNED_SHORT,0);o.bindFramebuffer(o.FRAMEBUFFER,Q[te].framebuffer);o.clearColor(0,0,0,0);o.clear(o.COLOR_BUFFER_BIT);o.drawElements(o.TRIANGLES,O.length,o.UNSIGNED_SHORT,0)}o.disable(o.DEPTH_TEST),o.enable(o.BLEND),o.blendFuncSeparate(o.SRC_ALPHA,o.ONE,o.ONE,o.ONE);var re={mode:"points",shape:"line",speed:"fast",bgColor:"black"},ie=o.POINTS,ne=I,oe=L*L,ae=1,ue=0,Te=ue*255;e.style.backgroundColor="rgb("+Te+", "+Te+", "+Te+")";var Ee=new dat.GUI;Ee.add(re,"mode",["points","line_strip","triangles"]).onChange(function(e){switch(e){case"line_strip":ie=o.LINE_STRIP;break;case"triangles":ie=o.TRIANGLES;break;case"points":default:ie=o.POINTS}}),Ee.add(re,"shape",["line","mesh"]).onChange(function(e){switch(e){case"mesh":ne=P;oe=(4*(L-1)+2)*(L-1);break;case"line":default:ne=I;oe=L*L}}),Ee.add(re,"speed",["fast","slow"]).onChange(function(e){switch(e){case"slow":ae=0;break;case"fast":default:ae=1}}),Ee.add(re,"bgColor",["black","white"]).onChange(function(t){switch(t){case"white":ue=1;break;case"black":default:ue=0}var r=ue*255;e.style.backgroundColor="rgb("+r+", "+r+", "+r+")"});var ce=Date.now(),fe=0,Re=0;function me(){fe=(Date.now()-ce)/1e3;var e=Re%2;var i=1-e;var a=o.createTexture(o.TEXTURE_2D);o.activeTexture(o.TEXTURE0);o.bindTexture(o.TEXTURE_2D,a);o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,t);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE);o.disable(o.BLEND);o.viewport(0,0,L,L);o.useProgram(f.program);o.bindFramebuffer(o.FRAMEBUFFER,z[e].framebuffer);S(C,f.attLocation,f.attStride,H);o[f.uniType[0]](f.uniLocation[0],[L,L]);o[f.uniType[1]](f.uniLocation[1],0);o.drawElements(o.TRIANGLES,O.length,o.UNSIGNED_SHORT,0);o.useProgram(R.program);o.bindFramebuffer(o.FRAMEBUFFER,K[e].framebuffer);S(C,R.attLocation,R.attStride);o[R.uniType[0]](R.uniLocation[0],[L,L]);o[R.uniType[1]](R.uniLocation[1],p+e);o[R.uniType[2]](R.uniLocation[2],p+i);o[R.uniType[3]](R.uniLocation[3],g+i);o.drawElements(o.TRIANGLES,O.length,o.UNSIGNED_SHORT,0);o.useProgram(d.program);o.bindFramebuffer(o.FRAMEBUFFER,J[e].framebuffer);S(C,d.attLocation,d.attStride,H);o[d.uniType[0]](d.uniLocation[0],_+i);o[d.uniType[1]](d.uniLocation[1],g+i);o[d.uniType[2]](d.uniLocation[2],[L,L]);o[d.uniType[3]](d.uniLocation[3],fe);o[d.uniType[4]](d.uniLocation[4],E);o.drawElements(o.TRIANGLES,O.length,o.UNSIGNED_SHORT,0);o.useProgram(l.program);o.bindFramebuffer(o.FRAMEBUFFER,Q[e].framebuffer);S(C,l.attLocation,l.attStride,H);o[l.uniType[0]](l.uniLocation[0],s+i);o[l.uniType[1]](l.uniLocation[1],_+e);o[l.uniType[2]](l.uniLocation[2],g+e);o[l.uniType[3]](l.uniLocation[3],[L,L]);o[l.uniType[4]](l.uniLocation[4],ae);o.drawElements(o.TRIANGLES,O.length,o.UNSIGNED_SHORT,0);o.enable(o.BLEND);o.useProgram(c.program);o.bindFramebuffer(o.FRAMEBUFFER,null);S(ne,c.attLocation,c.attStride);o.clearColor(0,0,0,0);o.clearDepth(1);o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT);o.viewport(0,0,r,n);T.identity(q);T.multiply(V,q,j);o[c.uniType[0]](c.uniLocation[0],false,j);o[c.uniType[1]](c.uniLocation[1],n);o[c.uniType[2]](c.uniLocation[2],p+e);o[c.uniType[3]](c.uniLocation[3],s+e);o[c.uniType[4]](c.uniLocation[4],ue);o.drawArrays(ie,0,oe);o.flush();++Re;if(u){requestAnimationFrame(me)}}u=true,me()}window.addEventListener("load",function(){if(e=document.getElementById("canvas"),r=window.innerWidth,n=window.innerHeight,e.width=r,e.height=n,null!=(o=e.getContext("webgl"))){T=new t.default,a={elementIndexUint:o.getExtension("OES_element_index_uint"),textureFloat:o.getExtension("OES_texture_float"),textureHalfFloat:o.getExtension("OES_texture_half_float")},window.addEventListener("keydown",function(e){u=27!==e.keyCode},!1),window.addEventListener("mousemove",function(e){var t=e.clientX/r*2-1,i=e.clientY/n*2-1;E=[t,-i]},!1);var i=F(v(require("../shader/scene.vert"),o.VERTEX_SHADER),v(require("../shader/scene.frag"),o.FRAGMENT_SHADER));if(null!=i){c=new A(i);var p=F(v(require("../shader/video.vert"),o.VERTEX_SHADER),v(require("../shader/video.frag"),o.FRAGMENT_SHADER));if(null!=p){f=new A(p);var g=F(v(require("../shader/picture.vert"),o.VERTEX_SHADER),v(require("../shader/picture.frag"),o.FRAGMENT_SHADER));if(null!=g){R=new A(g);var s=F(v(require("../shader/reset.vert"),o.VERTEX_SHADER),v(require("../shader/reset.frag"),o.FRAGMENT_SHADER));if(null!=s){m=new A(s);var _=F(v(require("../shader/position.vert"),o.VERTEX_SHADER),v(require("../shader/position.frag"),o.FRAGMENT_SHADER));if(null!=_){l=new A(_);var b,x=F(v(require("../shader/velocity.vert"),o.VERTEX_SHADER),v(require("../shader/velocity.frag"),o.FRAGMENT_SHADER));if(null!=x)d=new A(x),(b=document.createElement("video")).width=L,b.height=L,b.loop=!0,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia({video:!0},function(e){b.srcObject=e,b.addEventListener("canplay",function e(){b.removeEventListener("canplay",e),b.play(),U(b)})},function(e){prompt.innerHTML="Unable to capture WebCam. Please reload the page."})}}}}}}else console.log("webgl unsupported")},!1);var A=function e(t){i(this,e),this.program=t,this.attLocation=[],this.attStride=[],this.uniLocation=[],this.uniType=[]};function v(e,t){var r=o.createShader(t);return o.shaderSource(r,e),o.compileShader(r),o.getShaderParameter(r,o.COMPILE_STATUS)?r:(alert(o.getShaderInfoLog(r)),null)}function F(e,t){if(null!=e&&null!=t){var r=o.createProgram();return o.attachShader(r,e),o.attachShader(r,t),o.linkProgram(r),o.getProgramParameter(r,o.LINK_STATUS)?(o.useProgram(r),r):(alert(o.getProgramInfoLog(r)),null)}}function b(e){var t=o.createBuffer();return o.bindBuffer(o.ARRAY_BUFFER,t),o.bufferData(o.ARRAY_BUFFER,new Float32Array(e),o.STATIC_DRAW),o.bindBuffer(o.ARRAY_BUFFER,null),t}function x(e){var t=o.createBuffer();return o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t),o.bufferData(o.ELEMENT_ARRAY_BUFFER,new Int16Array(e),o.STATIC_DRAW),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,null),t}function S(e,t,r,i){for(var n in e)o.bindBuffer(o.ARRAY_BUFFER,e[n]),o.enableVertexAttribArray(t[n]),o.vertexAttribPointer(t[n],r[n],o.FLOAT,!1,0,0);null!=i&&o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,i)}function y(e,t,r){if(null!=e&&(null!=e.textureFloat||null!=e.textureHalfFloat)){var i=null!=e.textureFloat?o.FLOAT:e.textureHalfFloat.HALF_FLOAT_OES,n=o.createFramebuffer();o.bindFramebuffer(o.FRAMEBUFFER,n);var a=o.createTexture();return o.bindTexture(o.TEXTURE_2D,a),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,t,r,0,o.RGBA,i,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,a,0),o.bindTexture(o.TEXTURE_2D,null),o.bindFramebuffer(o.FRAMEBUFFER,null),{framebuffer:n,texture:a}}console.log("float texture not support")}}();
},{"./minMatrix.js":9,"../shader/scene.vert":10,"../shader/scene.frag":11,"../shader/video.vert":12,"../shader/video.frag":13,"../shader/picture.vert":12,"../shader/picture.frag":15,"../shader/reset.vert":12,"../shader/reset.frag":17,"../shader/position.vert":12,"../shader/position.frag":19,"../shader/velocity.vert":12,"../shader/velocity.frag":21}]},{},[6])